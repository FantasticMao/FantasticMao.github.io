---
title: OAuth 2.0 的研究与实践
date: 2017-04-26 11:07:48
categories: 毕业设计
---
# 摘要
OAuth 2.0 是由互联网工程任务组于 2012 年 10 月发表在 RFC-6749 规范文档中定义的认证授权协议，是一种基于 HTTP 重定向实现的开放授权框架。它允许用户让第三方应用访问该用户在某一网站上存储的私密的资源（如照片，视频，联系人列表），而无需将用户名和密码提供给第三方应用。本文先简单介绍 OAuth 2.0 协议的概念、基本流程和关键步骤，讨论了在开发 OAuth 2.0 应用时的注意事项，接着在充分阅读和理解 RFC-6749 规范和参考国内外主流网站的 OAuth 2.0 实现之上，设计并实现了一个基于 OAuth 2.0 协议的开放授权应用，指出了常规 OAuth 2.0 应用在登录流程中的不足之处，并给出优化方案，给予实践证明。
<!-- more -->

# 绪论

## 课题背景
随着互联网行业的蓬勃发展，网络站点和应用APP的越来越多，用户在不同应用之间的使用上出现了一个问题。为了使用不同厂商的应用，如「贴吧」、「淘宝」和「QQ」，用户必须为每个应用单独注册帐号。在注册少数大厂的帐号之后，用户还必须为成千上百的中小型应用注册帐号，这极其繁琐和非人性化的使用现状，使得互联网领域中必须尽快出现一个可以连接不同应用用户体系的可靠可行的规范协议，这就是 OAuth 协议。

在互联网工程任务组第73次会议上，举行了OAuth的起始会议，讨论了将OAuth协议纳入IETF做进一步的规范化工作。OAuth 协议第一版在 2010 年 4 月发表为 RFC-5849，但 RFC-5849 仅是一个非正式的 RFC。2012 年 10 月 OAuth 2.0 正式发布，它作为 OAuth 1.0 协议的下一版本但不向下兼容 OAuth 1.0。OAuth 2.0 协议关注客户端开发者的简易性，同时为Web、APP等多种客户端提供认证授权服务。目前各大主流网站均已支持 OAuth 2.0 协议。

## 研究意义
传统的客户端-服务端认证模式是基于cookie-session方式实现。为了认证客户端，服务端必须记录客户端的凭证，通常是用户名和密码，这使得不同应用之间无法相互共享用户数据。为解决这个问题，

## 本文的工作
1. 阅读 RFC-6479 规范文档，理解 OAuth 2.0 协议原理；
2. 实践证明 OAuth 2.0 协议的可行性与可靠性；
3. 引入 WebSocket 技术，优化 OAuth 2.0 应用中的繁琐流程。

---

# OAuth 2.0 协议

## 协议简介

## 协议角色
OAuth 定义了四个角色：

* resource owner
能授予访问 *受保护资源* 的实体。当 *资源所有者* 是人类的时候，被称为终端用户；
* resource server
托管 *受保护资源*，能接收和响应使用 *访问令牌* 访问 *受保护资源* 请求的服务器；
* client
代表 *资源所有者*，使用其授权凭据获取 *受保护资源* 的应用；
* authorization server
颁发 *访问令牌* 给成功认证并获得授权之后的 *客户端* 的服务器。

## 术语解释

## 基本流程
     +--------+                               +---------------+
     |        |--(A)- Authorization Request ->|   Resource    |
     |        |                               |     Owner     |
     |        |<-(B)-- Authorization Grant ---|               |
     |        |                               +---------------+
     |        |
     |        |                               +---------------+
     |        |--(C)-- Authorization Grant -->| Authorization |
     | Client |                               |     Server    |
     |        |<-(D)----- Access Token -------|               |
     |        |                               +---------------+
     |        |
     |        |                               +---------------+
     |        |--(E)----- Access Token ------>|    Resource   |
     |        |                               |     Server    |
     |        |<-(F)--- Protected Resource ---|               |
     +--------+                               +---------------+

协议主要流程：
1. 客户端向资源所有者请求授权。
2. 客户端收到*授权许可*，*授权许可*代表了资源所有者的授权凭据。
3. 客户端向授权服务器请求*访问令牌*。
4. 授权服务器认证*客户端身份*和验证其*授权许可*，若认证成功，则颁发*访问令牌*。
5. 客户端通过*访问令牌*，向资源服务器请求受保护资源。
6. 资源服务器验证请求中*访问令牌*，若验证成功，则响应对应的受保护资源。

## 关键步骤

### 认证

### 授权

## 注意事项 
注意事项：
* 术语*客户端*并非特指任何特定的的实现特点(例如:应用程序是否是在服务器、台式机或其他设备上执行)。
* 客户端从资源所有者获得授权许可(步骤1和2所示)的更好方法是使用授权服务器作为中介。
* 访问令牌所限制客户端的访问时间和访问范围，由资源服务器和认证服务器共同限制。
* 访问令牌可以表示一个取回授权信息的标识符，或者可以自包含相关授权信息（token字符串携带一些数据和签名）。
* 刷新令牌是可选的，有授权服务器决定，且刷新令牌只与授权服务器交互，与资源服务器无交互
* 客户端注册时，必须指定 **客户端类型** 和 **客户端回调域名** 以及可选的一些应用信息（如应用名称、描述、logo等）。
* 授权服务器必须支持 HTTP 基本认证（Base64编码 username:password 字符串），且授权服务器必须对客户端认证做次数限制。

---

# OAuth 2.0 应用实现

## 基本思路
a. 对比主流应用对 OAuth 2.0 协议的支持情况
b. 

## 实现方案

### 结构体系

#### 服务端结构体系

#### 客户端结构体系

## 实现细节
伪代码/流程图

## 运行效果

## 存在的问题
明确、充分

---

# OAuth 2.0 应用优化

## 产生原因

## 优化方案

### WebScoket 技术简介
WebSocket 是一种在单个 TCP 连接上进行双全工通讯的协议。WebSocket 通信协议于 2011 年被 IETF 定为标准 RFC-6455，并被 RFC-7936 所补充规范。WebSocket API也被W3C定为标准。

WebSocket 作为一种持久化协议，区别于非持久的 HTTP 协议。它相比于其它的信息传递方式，如「长连接 long poll」和「Ajax 轮询」，具有：
1. 较少的控制开销
2. 更强的实时性
3. 保持连接状态
4. 更好的二进制支持
5. 可以支持扩展
6. 更好的压缩效果

### 引入 WebSocket 技术

## 实现细节

## 测试效果

---

# 结束语
是对本课题工作的总结，与摘要中的内容对应，切勿写个人感言！！！

# 致谢